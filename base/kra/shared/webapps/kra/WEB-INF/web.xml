<?xml version="1.0" encoding="ISO-8859-1"?>
<web-app>

    <display-name>Key Recovery Authority</display-name>

   <servlet>
      <servlet-name>  kraheader  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.base.IndexServlet  </servlet-class>
             <init-param><param-name>  templatePath   </param-name>
                         <param-value> /agent/header.template</param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraheader   </param-value> </init-param>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> true        </param-value> </init-param>
             <init-param><param-name>  AuthMgr     </param-name>
                         <param-value> certUserDBAuthMgr </param-value> </init-param>
             <init-param><param-name>  template    </param-name>
                         <param-value> /agent/header.template </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraSrchRecoverKey  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.base.DisplayHtmlServlet  </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> true        </param-value> </init-param>
             <init-param><param-name>  htmlPath    </param-name>
                         <param-value> /agent/kra/SrchRecoverKey.html </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra         </param-value> </init-param>
             <init-param><param-name>  interface   </param-name>
                         <param-value> agent  </param-value> </init-param>
             <init-param><param-name>  templatePath   </param-name>
                         <param-value> /agent/kra/srchKeyForRecovery.template</param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraSrchRecoverKey </param-value> </init-param>
             <init-param><param-name>  unauthorizedTemplate  </param-name>
                         <param-value> /agent/kra/GenUnauthorized.template </param-value> </init-param>
             <init-param><param-name>  AuthMgr     </param-name>
                         <param-value> certUserDBAuthMgr </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraSrchKey  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.base.DisplayHtmlServlet  </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> true        </param-value> </init-param>
             <init-param><param-name>  htmlPath    </param-name>
                         <param-value> /agent/kra/SrchKey.html </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra         </param-value> </init-param>
             <init-param><param-name>  interface   </param-name>
                         <param-value> agent  </param-value> </init-param>
             <init-param><param-name>  templatePath   </param-name>
                         <param-value> /agent/kra/srchKey.template</param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraSrchKey  </param-value> </init-param>
             <init-param><param-name>  unauthorizedTemplate  </param-name>
                         <param-value> /agent/kra/GenUnauthorized.template </param-value> </init-param>
             <init-param><param-name>  AuthMgr     </param-name>
                         <param-value> certUserDBAuthMgr </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraListRequests  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.base.DisplayHtmlServlet  </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> true        </param-value> </init-param>
             <init-param><param-name>  htmlPath    </param-name>
                         <param-value> /agent/kra/ListRequests.html </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra         </param-value> </init-param>
             <init-param><param-name>  interface   </param-name>
                         <param-value> agent  </param-value> </init-param>
             <init-param><param-name>  templatePath   </param-name>
                         <param-value> /agent/kra/ListRequests.template</param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraListRequests </param-value> </init-param>
             <init-param><param-name>  unauthorizedTemplate  </param-name>
                         <param-value> /agent/kra/GenUnauthorized.template </param-value> </init-param>
             <init-param><param-name>  AuthMgr     </param-name>
                         <param-value> certUserDBAuthMgr </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraindex  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.base.IndexServlet  </servlet-class>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraindex    </param-value> </init-param>
             <init-param><param-name>  template    </param-name>
                         <param-value> index.template </param-value> </init-param>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> true        </param-value> </init-param>
             <init-param><param-name>  AuthMgr     </param-name>
                         <param-value> certUserDBAuthMgr </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraKRASrchKey  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.key.SrchKey  </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> true        </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra         </param-value> </init-param>
             <init-param><param-name>  templatePath   </param-name>
                         <param-value> /agent/kra/srchKey.template</param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraKRASrchKey </param-value> </init-param>
             <init-param><param-name>  AuthMgr     </param-name>
                         <param-value> certUserDBAuthMgr </param-value> </init-param>
             <init-param><param-name>  resourceID  </param-name>
                         <param-value> certServer.kra.keys </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraGrantRecovery  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.base.DisplayHtmlServlet  </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> true        </param-value> </init-param>
             <init-param><param-name>  htmlPath    </param-name>
                         <param-value> /agent/kra/GrantRecovery.html </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra         </param-value> </init-param>
             <init-param><param-name>  interface   </param-name>
                         <param-value> agent  </param-value> </init-param>
             <init-param><param-name>  templatePath   </param-name>
                         <param-value> /agent/kra/grantRecovery.template</param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraGrantRecovery </param-value> </init-param>
             <init-param><param-name>  unauthorizedTemplate  </param-name>
                         <param-value> /agent/kra/GenUnauthorized.template </param-value> </init-param>
             <init-param><param-name>  AuthMgr     </param-name>
                         <param-value> certUserDBAuthMgr </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraKRASrchKeyForRecovery  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.key.SrchKeyForRecovery  </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> true        </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra         </param-value> </init-param>
             <init-param><param-name>  templatePath   </param-name>
                         <param-value> /agent/kra/srchKeyForRecovery.template</param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraKRASrchKeyForRecovery </param-value> </init-param>
             <init-param><param-name>  AuthMgr     </param-name>
                         <param-value> certUserDBAuthMgr </param-value> </init-param>
             <init-param><param-name>  resourceID  </param-name>
                         <param-value> certServer.kra.keys </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraKRADisplayBySerial  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.key.DisplayBySerial  </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> true        </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra         </param-value> </init-param>
             <init-param><param-name>  templatePath   </param-name>
                         <param-value> /agent/kra/displayBySerial.template</param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraKRADisplayBySerial </param-value> </init-param>
             <init-param><param-name>  AuthMgr     </param-name>
                         <param-value> certUserDBAuthMgr </param-value> </init-param>
             <init-param><param-name>  resourceID  </param-name>
                         <param-value> certServer.kra.key </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  krapolicy  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.admin.KRAPolicyAdminServlet  </servlet-class>
             <init-param><param-name>  ID          </param-name>
                         <param-value> krapolicy   </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra         </param-value> </init-param>
   </servlet>

<!--
   <servlet>
      <servlet-name>  krajobsScheduler  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.admin.JobsAdminServlet  </servlet-class>
             <init-param><param-name>  ID          </param-name>
                         <param-value> krajobsScheduler </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
   </servlet>
-->

   <servlet>
      <servlet-name>  kraauths  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.admin.KRAAuthAdminServlet  </servlet-class>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraauths    </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraacl  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.admin.KRAACLAdminServlet  </servlet-class>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraacl      </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraug  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.admin.KRAUsrGrpAdminServlet  </servlet-class>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraug       </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
   </servlet>


   <servlet>
      <servlet-name>  kraserver  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.admin.KRACMSAdminServlet  </servlet-class>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraserver   </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  krakra  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.admin.KRAAdminServlet  </servlet-class>
             <init-param><param-name>  ID          </param-name>
                         <param-value> krakra      </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kralog  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.admin.LogAdminServlet  </servlet-class>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kralog      </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  services </servlet-name>
      <servlet-class> com.netscape.cms.servlet.csadmin.MainPageServlet </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> false       </param-value> </init-param>
             <init-param><param-name>  authorityId  </param-name>
                         <param-value> kra          </param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> services </param-value> </init-param>
             <init-param><param-name>  templatePath  </param-name>
                         <param-value> /services.template </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraUpdateNumberRange  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.csadmin.KRAUpdateNumberRange  </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> false       </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra          </param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraUpdateNumberRange </param-value> </init-param>
             <init-param><param-name>  interface   </param-name>
                         <param-value> admin       </param-value> </init-param>
             <init-param><param-name>  AuthMgr     </param-name>
                         <param-value> TokenAuth </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
             <init-param><param-name>  resourceID  </param-name>
                         <param-value> certServer.clone.configuration.UpdateNumberRange </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraDownloadPKCS12  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.csadmin.DownloadPKCS12  </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> false       </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra          </param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraDownloadPKCS12 </param-value> </init-param>
             <init-param><param-name>  interface   </param-name>
                         <param-value> ee          </param-value> </init-param>
             <init-param><param-name>  AuthMgr     </param-name>
                         <param-value> TokenAuth </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
             <init-param><param-name>  resourceID  </param-name>
                         <param-value> certServer.clone.configuration </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraGetStatus  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.csadmin.GetStatus  </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> false       </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra          </param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraGetStatus </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraUpdateDomainXML  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.csadmin.UpdateDomainXML  </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> true       </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra         </param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraUpdateDomainXML </param-value> </init-param>
             <init-param><param-name>  interface   </param-name>
                         <param-value> agent          </param-value> </init-param>
             <init-param><param-name>  AuthMgr     </param-name>
                         <param-value> certUserDBAuthMgr </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
             <init-param><param-name>  resourceID  </param-name>
                         <param-value> certServer.securitydomain.domainxml </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraUpdateDomainXML-admin  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.csadmin.UpdateDomainXML  </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> false       </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra         </param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraUpdateDomainXML </param-value> </init-param>
             <init-param><param-name>  interface   </param-name>
                         <param-value> admin          </param-value> </init-param>
             <init-param><param-name>  AuthMgr     </param-name>
                         <param-value> TokenAuth </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
             <init-param><param-name>  resourceID  </param-name>
                         <param-value> certServer.securitydomain.domainxml </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraGetCookie  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.csadmin.GetCookie  </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> false       </param-value> </init-param>
             <init-param><param-name>  AuthzMgr    </param-name>
                         <param-value> BasicAclAuthz </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra         </param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraGetCookie  </param-value> </init-param>
             <init-param><param-name>  AuthMgr     </param-name>
                         <param-value> passwdUserDBAuthMgr </param-value> </init-param>
             <init-param><param-name>  templatePath  </param-name>
                         <param-value> /admin/kra/sendCookie.template </param-value> </init-param>
             <init-param><param-name>  errorTemplatePath  </param-name>
                         <param-value> /admin/kra/securitydomainlogin.template </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraTokenAuthenticate  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.csadmin.TokenAuthenticate  </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> false       </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra         </param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraTokenAuthenticate  </param-value> </init-param>
             <init-param><param-name>  interface   </param-name>
                         <param-value> ee          </param-value> </init-param>
   </servlet>

   <servlet>
      <servlet-name>  kraTokenAuthenticate-admin  </servlet-name>
      <servlet-class> com.netscape.cms.servlet.csadmin.TokenAuthenticate  </servlet-class>
             <init-param><param-name>  GetClientCert  </param-name>
                         <param-value> false       </param-value> </init-param>
             <init-param><param-name>  authority   </param-name>
                         <param-value> kra         </param-value> </init-param>
             <init-param><param-name>  ID          </param-name>
                         <param-value> kraTokenAuthenticate  </param-value> </init-param>
             <init-param><param-name>  interface   </param-name>
                         <param-value> admin          </param-value> </init-param>
   </servlet>

   <servlet-mapping>
      <servlet-name>  kraserver  </servlet-name>
      <url-pattern>   /server  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  krakra  </servlet-name>
      <url-pattern>   /kra  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kralog  </servlet-name>
      <url-pattern>   /log  </url-pattern>
   </servlet-mapping>


   <servlet-mapping>
      <servlet-name>  kraug  </servlet-name>
      <url-pattern>   /ug  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraacl  </servlet-name>
      <url-pattern>   /acl  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraauths  </servlet-name>
      <url-pattern>   /auths  </url-pattern>
   </servlet-mapping>

<!--
   <servlet-mapping>
      <servlet-name>  krajobsScheduler  </servlet-name>
      <url-pattern>   /jobsScheduler  </url-pattern>
   </servlet-mapping>
-->

   <servlet-mapping>
      <servlet-name>  krapolicy  </servlet-name>
      <url-pattern>   /krapolicy  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraheader  </servlet-name>
      <url-pattern>   /agent/header  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraSrchRecoverKey  </servlet-name>
      <url-pattern>   /agent/kra/srchRecoverKey.html  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraSrchKey  </servlet-name>
      <url-pattern>   /agent/kra/srchKey.html  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraListRequests  </servlet-name>
      <url-pattern>   /agent/kra/listRequests.html  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraindex  </servlet-name>
      <url-pattern>   /index  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraKRASrchKey  </servlet-name>
      <url-pattern>   /agent/kra/srchKey  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraGrantRecovery  </servlet-name>
      <url-pattern>   /agent/kra/grantRecovery.html  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraKRASrchKeyForRecovery  </servlet-name>
      <url-pattern>   /agent/kra/srchKeyForRecovery  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraKRADisplayBySerial  </servlet-name>
      <url-pattern>   /agent/kra/displayBySerial  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  services </servlet-name>
      <url-pattern>   /services  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraUpdateNumberRange </servlet-name>
      <url-pattern>   /admin/kra/updateNumberRange  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraDownloadPKCS12 </servlet-name>
      <url-pattern>   /admin/console/config/savepkcs12 </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraGetStatus  </servlet-name>
      <url-pattern>   /admin/kra/getStatus  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraUpdateDomainXML </servlet-name>
      <url-pattern>   /agent/kra/updateDomainXML  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraUpdateDomainXML-admin </servlet-name>
      <url-pattern>   /admin/kra/updateDomainXML  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraGetCookie </servlet-name>
      <url-pattern>   /admin/kra/getCookie  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraTokenAuthenticate </servlet-name>
      <url-pattern>   /ee/kra/tokenAuthenticate  </url-pattern>
   </servlet-mapping>

   <servlet-mapping>
      <servlet-name>  kraTokenAuthenticate-admin </servlet-name>
      <url-pattern>   /admin/kra/tokenAuthenticate  </url-pattern>
   </servlet-mapping>

    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Account Services</web-resource-name>
            <url-pattern>/rest/account/*</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>*</role-name>
        </auth-constraint>
        <user-data-constraint>
            <transport-guarantee>CONFIDENTIAL</transport-guarantee>
        </user-data-constraint>
    </security-constraint>

    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Admin Services</web-resource-name>
            <url-pattern>/rest/admin/*</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>*</role-name>
        </auth-constraint>
        <user-data-constraint>
            <transport-guarantee>CONFIDENTIAL</transport-guarantee>
        </user-data-constraint>
    </security-constraint>

    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Agent Services</web-resource-name>
            <url-pattern>/rest/agent/*</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>*</role-name>
        </auth-constraint>
        <user-data-constraint>
            <transport-guarantee>CONFIDENTIAL</transport-guarantee>
        </user-data-constraint>
    </security-constraint>

    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Audit</web-resource-name>
            <url-pattern>/rest/audit/*</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>*</role-name>
        </auth-constraint>
        <user-data-constraint>
            <transport-guarantee>CONFIDENTIAL</transport-guarantee>
        </user-data-constraint>
    </security-constraint>

    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Security Domain Services</web-resource-name>
            <url-pattern>/rest/securityDomain/installToken</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>*</role-name>
        </auth-constraint>
        <user-data-constraint>
            <transport-guarantee>CONFIDENTIAL</transport-guarantee>
        </user-data-constraint>
    </security-constraint>

    <security-constraint>
        <web-resource-collection>
            <web-resource-name>Self Tests</web-resource-name>
            <url-pattern>/rest/selftests/*</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>*</role-name>
        </auth-constraint>
        <user-data-constraint>
            <transport-guarantee>CONFIDENTIAL</transport-guarantee>
        </user-data-constraint>
    </security-constraint>

    <login-config>
        <realm-name>Key Recovery Authority</realm-name>
    </login-config>

    <security-role>
        <role-name>*</role-name>
    </security-role>

</web-app>
